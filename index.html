<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mampara ZA</title>

    <!-- React & Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- html2canvas -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <style>
        body { background-color: #f3f4f6; font-family: sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect } = React;

const LinkIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"
         viewBox="0 0 24 24" fill="none" stroke="currentColor"
         strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"
         className="text-white drop-shadow-2xl">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
    </svg>
);

const monthsList = [
    "January","February","March","April","May","June",
    "July","August","September","October","November","December"
];

const yearsList = [2025, 2026, 2027, 2028];

const DATA_URL =
    'https://raw.githubusercontent.com/CliffortMC08/mampara-za-data/main/content.json';

function App() {
    const [data, setData] = useState({});
    const [selectedYear, setSelectedYear] = useState(2026);

    useEffect(() => {
        fetch(DATA_URL)
            .then(res => res.json())
            .then(setData);
    }, []);

    const getMonthVideos = (month) =>
        (data[selectedYear]?.[month]) || [];

    /* FULL PAGE DOWNLOAD â€” GUARANTEED */
    const downloadPageAsImage = async () => {
        const body = document.body;

        /* Store original styles */
        const originalOverflow = body.style.overflow;
        const stickyEls = document.querySelectorAll('.sticky');

        /* Disable sticky & scrolling */
        body.style.overflow = 'visible';
        stickyEls.forEach(el => el.style.position = 'static');

        await new Promise(r => setTimeout(r, 300)); // allow layout reflow

        const canvas = await html2canvas(body, {
            scale: 2,
            useCORS: true,
            backgroundColor: '#f3f4f6',
            height: body.scrollHeight,
            width: body.scrollWidth,
            windowHeight: body.scrollHeight
        });

        /* Restore styles */
        body.style.overflow = originalOverflow;
        stickyEls.forEach(el => el.style.position = 'sticky');

        const link = document.createElement('a');
        link.download = `Mampara_ZA_${selectedYear}_FULL_PAGE.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
    };

    return (
        <div className="min-h-screen pb-20">

            <header className="bg-black text-white py-10">
                <div className="container mx-auto px-6 text-center">
                    <h1 className="text-6xl font-black text-yellow-400">
                        Mampara ZA
                    </h1>
                    <p className="mt-3 text-xl text-green-300">
                        South Africa's Viral Hall of Fame ðŸ‡¿ðŸ‡¦
                    </p>
                </div>
            </header>

            <div className="bg-white sticky top-0 z-50 shadow-md">
                <div className="container mx-auto flex justify-center gap-4 py-5 px-6">
                    {yearsList.map(year => (
                        <button key={year}
                            onClick={() => setSelectedYear(year)}
                            className={`px-8 py-3 rounded-full font-bold ${
                                selectedYear === year
                                    ? 'bg-green-600 text-white'
                                    : 'bg-gray-200'
                            }`}>
                            {year}
                        </button>
                    ))}
                </div>
            </div>

            <div className="container mx-auto px-6 py-6 flex justify-center">
                <button
                    onClick={downloadPageAsImage}
                    className="px-8 py-3 rounded-full bg-black text-yellow-400 font-bold">
                    Download Full Page ðŸ“¸
                </button>
            </div>

            <div className="container mx-auto px-6 py-10 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                {monthsList.map(month => (
                    <div key={month} className="bg-white rounded-3xl shadow-xl">
                        <div className="bg-gradient-to-r from-green-600 via-yellow-400 to-black text-white px-6 py-4">
                            <h3 className="text-2xl font-bold">{month} {selectedYear}</h3>
                        </div>
                        <div className="p-6 grid grid-cols-3 gap-4">
                            {getMonthVideos(month).map((v, i) => (
                                <img key={i} src={v.thumbnail}
                                     className="rounded-xl object-cover"/>
                            ))}
                        </div>
                    </div>
                ))}
            </div>

        </div>
    );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
